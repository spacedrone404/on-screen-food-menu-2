(()=>{const e=[{name:"Cold dishes",container:"menuContainerCold"},{name:"First courses",container:"menuContainerFirst"},{name:"Second courses",container:"menuContainerSecond"},{name:"Side dishes",container:"menuContainerSide"},{name:"Drinks",container:"menuContainerDrinks"},{name:"Bakery",container:"menuContainerBakery"},{name:"Bread",container:"menuContainerBread"}];let t=[];const n=e.map((({name:e,container:n})=>fetch(`app/list.php?category=${encodeURIComponent(e)}`).then((e=>e.json())).then((i=>(t=t.concat(i.map((t=>({...t,category:e})))),{container:n,data:i})))));function i(t,n){const i=document.getElementById(t);i.innerHTML="",n.forEach((e=>{let t=`\n      <div class="menu-item" data-id="${e.id}">\n        <div class="menu-weight editable" data-field="code" contenteditable="true" data-original="${e.code}">${e.code}</div>\n        <div class="menu-info">\n          <div class="menu-title editable" data-field="title" contenteditable="true" data-original="${e.title}">${e.title}</div>\n          <div class="menu-description editable" data-field="description" contenteditable="true" data-original="${e.description}">${e.description}</div>\n        </div>\n        <div class="menu-weight editable" data-field="weight" contenteditable="true" data-original="${e.weight}">${e.weight} g</div>\n        <div class="menu-price editable" data-field="price" contenteditable="true" data-original="${e.price}">${e.price} $</div>\n        <div class="save-delete-align"><button class="save-btn" style="display: none;">âˆš</button>\n        <button class="delete-btn">X</button>\n        </div>\n      </div>\n    `;i.innerHTML+=t})),i.querySelectorAll(".editable").forEach((e=>{e.addEventListener("focus",(function(){"weight"===this.dataset.field&&(this.textContent=this.textContent.replace(" g","")),"price"===this.dataset.field&&(this.textContent=this.textContent.replace(" $",""))})),e.addEventListener("blur",(function(){const e=this.dataset.original;let t=this.textContent;"weight"!==this.dataset.field||t.includes(" g")||(t+=" g",this.textContent=t),"price"!==this.dataset.field||t.includes(" $")||(t+=" $",this.textContent=t);const n=this.closest(".menu-item").querySelector(".save-btn"),i=t.replace(/ g| $/g,"");n.style.display=i!==e?"inline-block":"none"})),e.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),this.blur())}))})),i.querySelectorAll(".save-btn").forEach((t=>{t.addEventListener("click",(function(){!function(t){const n=document.querySelector(`.menu-item[data-id="${t}"]`),i={id:t,code:n.querySelector('[data-field="code"]').textContent,title:n.querySelector('[data-field="title"]').textContent,description:n.querySelector('[data-field="description"]').textContent,weight:n.querySelector('[data-field="weight"]').textContent.replace(" g",""),price:n.querySelector('[data-field="price"]').textContent.replace(" $",""),category:e.find((e=>document.getElementById(e.container).contains(n))).name};fetch("app/list.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>e.json())).then((e=>{e.success?(n.querySelectorAll(".editable").forEach((e=>{const t=e.textContent.replace(/ g| $/g,"");e.dataset.original=t})),n.querySelector(".save-btn").style.display="none",alert("Item updated successfully")):alert("Error updating item: "+e.error)})).catch((e=>{alert("Error: "+e.message)}))}(this.closest(".menu-item").dataset.id)}))})),i.querySelectorAll(".delete-btn").forEach((e=>{e.addEventListener("click",(function(){const e=this.closest(".menu-item");var t,n;t=e.dataset.id,n=e,confirm("Are you sure you want to delete this item?")&&fetch("app/list.php",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}).then((e=>e.json())).then((e=>{e.success?(n.remove(),alert("Item deleted successfully")):alert("Error deleting item: "+e.error)})).catch((e=>{alert("Error: "+e.message)}))}))})),function(e,t){const n=document.querySelector(`#category + #${e}`);n&&n.previousElementSibling&&(n.previousElementSibling.style.display=t?"block":"none")}(t,n.length>0)}Promise.all(n).then((n=>{n.forEach((({container:e,data:t})=>{i(e,t)})),document.getElementById("searchBar").addEventListener("input",(function(){!function(n){e.forEach((e=>{document.getElementById(e.container).innerHTML=""}));const a=t.filter((e=>e.title.toLowerCase().includes(n)||e.code.toLowerCase().includes(n))).reduce(((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e)),{});e.forEach((e=>{const t=a[e.name]||[];i(e.container,t)}))}(this.value.toLowerCase())}))}))})();